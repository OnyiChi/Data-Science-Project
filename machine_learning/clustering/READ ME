\documentclass{article}
\usepackage{hyperref}
\usepackage{graphicx}

\title{Mall Customer Segmentation}
\author{}
\date{}

\begin{document}

\maketitle

\section*{Table of Contents}
\begin{enumerate}
    \item \hyperref[sec:introduction]{Introduction}
    \item \hyperref[sec:dataset]{Dataset}
    \item \hyperref[sec:dependencies]{Dependencies}
    \item \hyperref[sec:data-preprocessing]{Data Preprocessing}
    \item \hyperref[sec:data-visualization]{Data Visualization}
    \item \hyperref[sec:customer-segmentation]{Customer Segmentation}
    \item \hyperref[sec:results]{Results}
    \item \hyperref[sec:license]{License}
\end{enumerate}

\section*{Introduction}
\label{sec:introduction}
Customer segmentation is crucial for businesses to understand their customer base and tailor their marketing strategies accordingly. This project uses K-Means clustering to segment customers based on their age, annual income, and spending score.

\section*{Dataset}
\label{sec:dataset}
The dataset used in this project is \texttt{Mall\_Customers.csv}, which contains the following columns:
\begin{itemize}
    \item CustomerID
    \item Gender
    \item Age
    \item Annual Income (k\$)
    \item Spending Score (1-100)
\end{itemize}

\section*{Dependencies}
\label{sec:dependencies}
To run the code in this repository, you'll need the following libraries:
\begin{itemize}
    \item \texttt{numpy}
    \item \texttt{pandas}
    \item \texttt{matplotlib}
    \item \texttt{seaborn}
    \item \texttt{scikit-learn}
\end{itemize}
You can install these libraries using pip:
\begin{verbatim}
pip install numpy pandas matplotlib seaborn scikit-learn
\end{verbatim}

\section*{Data Preprocessing}
\label{sec:data-preprocessing}
The data preprocessing steps include:
\begin{enumerate}
    \item Importing the dataset.
    \item Renaming columns for consistency.
    \item Checking for missing values.
    \item Dropping unnecessary columns (like CustomerID).
\end{enumerate}

\begin{verbatim}
import numpy as np
import pandas as pd

# Load the dataset
df = pd.read_csv("Mall_Customers.csv")

# Rename columns
df.rename(columns={'Genre': 'Gender'}, inplace=True)

# Drop the CustomerID column
df.drop(["CustomerID"], axis=1, inplace=True)
\end{verbatim}

\section*{Data Visualization}
\label{sec:data-visualization}
Various plots are created to understand the distribution of different attributes and their relationships.

\subsection*{Distribution Plots}
\begin{verbatim}
import matplotlib.pyplot as plt
import seaborn as sns

# Plotting the distribution of Age, Annual Income, and Spending Score
plt.figure(1, figsize=(15,6))
for i, col in enumerate(['Age', 'Annual Income (k$)', 'Spending Score (1-100)']):
    plt.subplot(1, 3, i+1)
    sns.distplot(df[col], bins=20)
    plt.title(f'Distribution Plot of {col}')
plt.show()
\end{verbatim}

\subsection*{Count Plot for Gender}
\begin{verbatim}
plt.figure(figsize=(15,5))
sns.countplot(y='Gender', data=df)
plt.show()
\end{verbatim}

\subsection*{Violin Plots}
\begin{verbatim}
plt.figure(1, figsize=(15,7))
for i, col in enumerate(['Age', 'Annual Income (k$)', 'Spending Score (1-100)']):
    plt.subplot(1, 3, i+1)
    sns.violinplot(x=col, y='Gender', data=df)
    plt.title('Violin Plot')
plt.show()
\end{verbatim}

\section*{Customer Segmentation}
\label{sec:customer-segmentation}
\subsection*{K-Means Clustering}
We use the K-Means clustering algorithm to segment customers into different groups based on their attributes.

\subsubsection*{Clustering Based on Age and Spending Score}
\begin{verbatim}
from sklearn.cluster import KMeans

X1 = df[['Age', 'Spending Score (1-100)']].values
wcss = []
for k in range(1, 11):
    kmeans = KMeans(n_clusters=k, init='k-means++')
    kmeans.fit(X1)
    wcss.append(kmeans.inertia_)

plt.figure(figsize=(12,6))
plt.plot(range(1, 11), wcss, linewidth=2, color='red', marker='8')
plt.xlabel('K Value')
plt.ylabel('WCSS')
plt.show()

kmeans = KMeans(n_clusters=4)
labels = kmeans.fit_predict(X1)

plt.scatter(X1[:, 0], X1[:, 1], c=labels, cmap='rainbow')
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], color='black', marker='x')
plt.title('Clusters of Customers')
plt.xlabel('Age')
plt.ylabel('Spending Score (1-100)')
plt.show()
\end{verbatim}

\subsubsection*{Clustering Based on Annual Income and Spending Score}
\begin{verbatim}
X2 = df[['Annual Income (k$)', 'Spending Score (1-100)']].values
wcss = []
for k in range(1, 11):
    kmeans = KMeans(n_clusters=k, init='k-means++')
    kmeans.fit(X2)
    wcss.append(kmeans.inertia_)

plt.figure(figsize=(12,6))
plt.plot(range(1, 11), wcss, linewidth=2, color='red', marker='8')
plt.xlabel('K Value')
plt.ylabel('WCSS')
plt.show()

kmeans = KMeans(n_clusters=5)
labels = kmeans.fit_predict(X2)

plt.scatter(X2[:, 0], X2[:, 1], c=labels, cmap='rainbow')
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], color='black', marker='x')
plt.title('Clusters of Customers')
plt.xlabel('Annual Income (k$)')
plt.ylabel('Spending Score (1-100)')
plt.show()
\end{verbatim}

\section*{Results}
\label{sec:results}
After clustering, we can visualize the segmented customer groups. The clustering results provide insights into different customer segments based on their age, annual income, and spending scores.

\section*{License}
\label{sec:license}
This project is licensed under the MIT License - see the \texttt{LICENSE} file for details.

\end{document}
